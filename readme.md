## Стек Технологий

Проект разработан с использованием следующих технологий: **Symfony**, **PostgreSQL**, **Redis**, **MailHog**, **Cron**.

---
## Реализация Проекта

### Регистрация Пользователя

Форма регистрации включает поля: **почта**, которая должна быть уникальной, **город**, **частоту обновлений**: почасово или подневно. Для поля "город" реализовано выпадающее меню, отображающее возможные варианты по мере ввода пользователем. Запрос к API для поиска городов кэшируется, что обеспечивает быстрый отклик при повторном вводе. 

### Управление Токенами и Подтверждение Подписки

После успешной регистрации система генерирует два **JWT** токена. **Короткий токен** используется для подтверждения подписки; он включается в ссылку, отправляемую на электронную почту пользователя, и действует 24 часа. Переход по этой ссылке активирует подписку, устанавливая соответствующий флаг в базе данных. **Длинный токен** предназначен для поддержания авторизации, записывается в куки браузера пользователя и содержит зашифрованный email.

### Авторизация и Доступ к Основной Странице

При загрузке основной страницы происходит автоматическая проверка. Из куки извлекается длинный токен, из которого декодируется email пользователя. Затем система проверяет наличие и активацию подписки в базе данных. Если подписка отсутствует или не активирована, пользователь перенаправляется на страницу логина.

### Основная Страница и Кэширование Погоды

Основная страница делает только один запрос к сервису погоды при первом входе пользователя. Полученный ответ кэшируется, что предотвращает неограниченное получение текущей погоды. В зависимости от выбранной пользователем частоты обновлений (почасово или подневно) запускаются две команды cron, которые обновляют кэш погоды для всех соответствующих подписок.

### Управление Аккаунтом

Пользователь может **разлогиниться** из аккаунта. При этом куки с длинным токеном удаляются, и для повторного доступа к странице погоды потребуется новая авторизация. Также пользователь может **удалить подписку**, что полностью удаляет запись из базы данных и токен из куки.

---

## Визуализация и Тестирование

Приложение обладает **полностью реализованным пользовательским интерфейсом**. Добавлены **юнит-тесты**, проверяющие создание сущности подписки, поиск городов и запросы к основному контроллеру (главная страница). Для удобства создан файл, позволяющий запускать все тесты сразу или выборочно тестировать один компонент.<br> 
Для запуска тестов:
* chmod +x run_tests.sh
* ./tests/run_tests.sh
---

## Запуск Проекта

* git clone https://github.com/StanislavKertytsia/genesis_weather.git
* chmod +x deploy_dev.sh
* **deploy_dev.sh --resetdb**: команда поднимает все сервисы Docker, удаляет данные из базы, загружает новые из fixtures, выполняет миграции и очищает кэш приложения.
* **deploy_dev.sh**: команда поднимает все сервисы Docker, выполняет миграции и очищает кэш приложения.
* **app**: http://localhost:8080/
* **mail**: http://localhost:8025/